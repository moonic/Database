# Database System Achieve

* what Database 
	* 运行用户使用数据定义语言来创建新的数据库并制定模式(数据逻辑机构)
	* 运行用户收到的语言来查询
	* 支持大量数据插曲存储
	* 数据具有持久性 
	* 控制多个用对数据继续访问 不允许用户有不恰当的印象

* 查询响应
	* 查询编译器对插叙分许和优化 得到查询集合或者动作系列 传递给执行引擎
	向资源管理器发出对消的数据 通常是记录关系的元组请求 
	* 资源管理器掌握关系存放的数据文件 文件中的数据格式和记录大小支持对数据文件元组继续查找的索引文件
	* 缓存区管理器和存储管理器进行通信 从磁盘获取数据 可以使用操作系统的命令

* 事务处理
	* 组成一组的诺干个查询和其他动作必须作为原子被孤立执行的单位 
	查询动作自身就是一个是 事务的执行必须是持久的任何已经完成的 事务不懈保留下来
		* 并发控制管理器或者调度器 复制保证事务的原子性 和孤立性 
		* 日志和恢复管理器 负责事务的持久性

* 主存和缓存区管理器 
	* 辅助管理器是磁盘 数据必须在主存储器中 才能对有拥有的操作 存储管理器的任务是控制
	磁盘必须在主存储器中 DBMS通常在磁盘上控制存储 复制需要的文件磁盘块号
	* 缓存区管理器负责将可以利用的主存储空间分割成数据块 所有从磁盘的奥信息的DBMS成的信息类型包括
		* 数据自身的内容
		* 元数据 模式数据结构以其约束的数据库模式
		* 日志记录 最近对数据库改变的信息 支持数据库的持久性
		* 统计信息 DBMS存储关系数据库中对各种关系其他成分的大小
		* 索引 支持对数据库进行高效存取的数据结构 

* 事务处理
	* 将一个或者多个数据库操作组成一组成为事务 必须被作为一个院子
	外观独立其他事务执行的单位 DBMS 保证持久性 已经完成的事务工作不贵丢失
	接收事务名利得知事务什么时候加锁 什么时候结束
		* 日志记录 数据库的变换在磁盘上记录的日志 无论什么时候发生故障恢复将管理器
		写入到缓存区 人韩红与缓存区管理协调 
		* 并发控制 喜多事务同时执行 调度器(并发控制管理器)保证多个事务一个动作适当的顺序
		执行 从而得到结果与是上执行的结果相同
		* 死锁解决 事务之间通过调度授锁进行资源竞争 没有一个事务能进行下去 需要从另一个是
		持有的资源 管理器有责任进行该与 取消回滚一个或多个事务从而能进行下去
	* 事务ACID特性

* 查询处理器
	* DBMS 对于用户观察到执行影响最大的是查询优化器
	* 查询编译器 将查询翻译一种内部形式 成为查询集合
		* 查询计划的操作是关系代数上的实现
		* 查询分析器 文本形式的查询出发建立一个树结构
		* 查询预处理器 语义检查 是否确实存在
		* 查询优化器 最初的查询计划转换为实际数据有效的操作顺序
	* 执行引擎
		* 负责执行查询计划中每一步 执行引擎与DBMS多数其他的成分有交互
		* 将数据库的数据取到缓存区 与调度器交互

* 关系模型
	* 关系是元组的集合 元组是值的列表 一个关系元组有相同数目的分量
	* 展示关系的方法是将元组作为行列出俩 列头成为属性表示分量的含义 
	* 关系名属性名 称为关系的模式

* SQL语句
	* 取from字句列出关系元组的所有集合
	* 不符合where条件的元组除去
	* 如果有grou by字句 删除元组给出属性值的分组 
	* 有having 安装字句检查每个组
	* select 字句指定的数据和属性上的聚集
	* order by 属性对应的元组排序

## 数据库系统的实现

* 辅助存储管理
	* 磁盘和其他存储大量需要长期保存的数据设备和结构
	* 磁盘上数据的组织形式对访问速度的影响 提高磁盘的可靠性的机制
	* 数据是如何表示 元组类似记录是如何被存储的效率是关键

* 存储器的层次
	* 高速缓存(Cache) 1M或者更多的高速花村 扳级高速缓存位于微处理本身的
	附加的二级高速缓存 处理需要的数据和指令时 被内存加载到高速缓存区中只需要几纳秒
	* 主存储器 计算机的活动中心 计算机中的每件事件都是驻在内存的信息上
	* 辅助存储器 典型的辅助存储器是磁盘数据传输速度的问题还是比较复杂的
	* 第三级 存储器 保存以兆字节计数的数据 读写时间长的多 每个字节的花费比磁盘小 

* 磁盘
	* 磁盘存储器的使用是数据管理系统重要的特性之一 存储器基于磁盘的
	DBMS实现的理由研究磁盘的操作

* 磁盘结构
	* 磁盘组合 
		* 多个圆盘组成围绕一个主轴磁盘上覆盖磁性材料二进制数据被保留一般的直径是3.5英寸 
		* 组成磁道单个盘片上的同心园 屏半径构成挂面磁道组成扇区 是被间隙分割的园盘片段 写入磁盘莱索扇区是不可分割的单位 
		* 如果一部分被损坏 这个部分就不能被使用 间隙占磁道的10% 标注扇区的起点
	* 磁头
		* 每个盘上有一个磁头 贴近的悬浮在盘面上但不与盘面接触 被固定在一个磁头上所有

* 磁盘控制器
	* 一个或多个磁盘控制器控制是个小处理器能完成以下功能	
		* 控制移动磁盘的机器马达
		* 扇区的柱面选择一个扇区 达到要求的扇区移动到磁头下面的那个点
		* 将有一条或多条磁道存在磁盘控制器的主内存中 扇区能被多次读取

* 磁盘存取特性
	* 磁盘控制器将磁盘的磁头组合定位在磁道的柱面上需要的寻道时间(seek time)
	* 磁盘控制器等待访问时间的第一个扇叶的磁头下 成为旋转延迟
	* 磁盘控制器存取或者写入数据的时候 间隙经过磁盘 这个时间称为磁盘的延迟
	* 寻道时间 旋转养成 的时间总称为为传输时间

* 加速对于辅助存储器的访问
	* 磁盘上使用的时间不等于个 某个应用程序 
	* 如果数据库系统将数据请求发送到控制器10m得到的时间
	* 最坏的时候磁盘访问的请求达到这个数超过10ms一次 

* 计算的IO模型
	* 一台运算DBMS的计算机成为长训小改数据库等不同的方式继续
	访问对用户进行提供服务 一个计算机有一个处理器 一个磁盘控制一个磁盘
	数据库本身太大至于存储器容纳不下 定下了计算机的IO模型
		* i/O  开销的主导地位次序磁盘写花费的时间比模拟主磁盘中数据
		小的多 块访问磁盘就是算法所有的时间的近视值
* 柱面组织数据
	* 寻道的时间占平均访问时间的一半 将可能被访问的数据 列如关系存储在
	单柱面上或附近的柱面上是有意义的 可以选择联系徐的几个块
	* 第一次寻道的诗经和低一些旋转等待的时间 而忽略其他时间  

* 使用多个磁盘
	* 使用多个独立磁盘(独立的磁头组)来代替一个磁盘(多个磁头组合在一起)能提高完美的系统性能
	任何单一磁盘快的访问速度没有变化 如果有几个磁盘则称分割技术提高大的数据库对象的访问速度

* 磁盘镜像
	* 更多的磁盘保存同样的数据副本被成为相互镜像 不会因为磁头的数据被
	损坏而别损坏因为磁盘上的镜像数据还是可以读取的
	* 增强可以设计的系统陈勇磁盘互为镜像 有n个磁盘则保存相同的数据速度将提高n倍

* 磁盘调度和电梯算法
	* 提高系统吞吐率然磁盘控制诺干请求选择来执行 系统需要按照一定的顺序访问磁盘块的
	地方将无法使用 请求来自独立的进程 得到公平的调度
	* 调度大连请求简答有效的方法称为 电梯算法 将磁头看做跨磁盘的扫描从柱面内圈到外圈
	然后再返回 当磁盘达到方向的一个位置将在该位置的强不在有访问请求 磁头朝反方向移动
		* 先到达先服务 来描述电梯算法块到达请求的柱面的时间最短

* 预取和大规模缓存
	* 加快对辅助存储器书暗访的最后一个建议成为预取 有时候也成为双缓存 
	能预测从磁盘请求的顺序 能在这些块装入主存 能较少的访问等待时间
	* 在一些应用中预测从磁盘请求块的顺序需要将块装入主存中能较好的调度磁盘通过电梯算法减少访问块需要的
	平均时间 极端的情况上有很多请求在得带每个请求寻道的速度小于平均寻道的时间

* 稳定存储	
	* 覆盖了扇区先前的故障存在但不能帮助纠正读出的内容 现象是严重的
	扇区的内如是把更新的余额中去只需要判断操作是否成功即可
	* 对存在一个磁盘或者多个磁盘执行一个称谓稳定存储的策略 磁盘的成对的每一堆代表一个扇区的内容
	将这个扇区拷贝到旁边足够多奇偶来效验位写排除扇区实际是坏扇区的可能性 

* 稳定存储的错误处理能力
	* 介质故障 将X存入扇区X1 X2 后介质故障变成永久不可读取的
	* 写故障   写入X的时候由一个系统故障 比如断电在X主存被丢失的可能
		* 故障在写的时候发生将X状态是坏的 这样能快速获取

* 磁盘恢复
	* 磁盘故障严重 磁盘损坏 磁头损坏 数据被永久破坏如果数据没有备份另一种介质中
	对重要的DBMS如银行金融机构来说是在哪
	* 复制扇区的冗余技术 复制扇区等思想一般属于是RAID(Rea dundant Array of Independent Disk 独立磁盘冗余阵列)
	一般由平均失效时间来衡量 一半的磁盘会坏掉不可恢复 

* 奇偶块
	* 减少磁盘彭辉造成数据丢失的可能有效防范 使用的冗余胖与拥有的数据盘一样多常称为RAID leve 4的一种方法
	常被成为RAID leve4 的；另一种方法仅使用一个冗余盘不管有多少磁盘 是相同的给每个磁盘偏好
	磁盘块有相同的二进制位数取冗余盘位的条件为真
	* 奇数个数第i个快所有的数据盘奇偶效验位组成 
		* 读被改变的数据盘上的旧值
		* 读冗余盘的相应块
		* 写数据块
		* 重新计算并写冗余盘的块

* 组织磁盘上的数据
	* 如何在磁盘上存储数据库 使用一个记录来表示一个数据(元组或对象)
	在磁盘块中的联系字节存放
	* 通过表示数据元素的记录存在一个或多个磁盘块俩表示关系的数据集合
	一个磁盘存放一个关系的元素是常用的组织方式 
	* 定长纪录
		* 元组的每个属性对应的一个字段 数据开始的地址4或8的倍数
		没有被前面的字段使用的空浪费了字段 
		* 纪录虽然被存在辅助存储器而不是存放内存中记录依然在内存中进行
		记录能被之路内存的有效访问是必要的
			* 一个指向记录中存储数据模式的指针 可以执行该元组所属的关系模式可以帮助我们找到记录字段
			* 记录长度 班组我们在不用查看模式情况下的记录
			* 时间戳 表示记录最后一次被使用的的时间 在数据库事务繁忙会有使用
			* 指向记录字段的指针 可以代替模式信息 
	
* PC-Server System
	*　系统数包括服务进程是一个客户端提供的二级缓存　客户进程是数据的应用服务器的主机在一个
	机器上　或者很多二级可以分布在许多机器上
	*  客户加决定使用的虚拟地址分配空间成为32位地址 DBMS决定地址空间在那些内存中 而是见虚拟空间映射为主机物理地址
	虚拟物理转换的问题	

* 物理地址 是字节串
	*　确定二级存储系统内快或者记录的位置
	×　存储链接的的主机 数据库存储不止在一台主机上
	* 快存储在的磁盘或者其他设备的标识符
	* 磁盘的柱面 磁道号 磁道内块好
	* 记录其实地址在块内的偏移量

* 逻辑地址　每个块记录有一个逻辑地址　
	* 存储在磁盘上已知的位置的映射表将逻辑地址物理地址联系起来
		*　物理地址很长包含列出元素　８字节是最下最小的长度　使用更多的自己
		每个机器创建对象　最小需要１０个自己来表示主机 内外表示存储的那样

* 逻辑地址和结构地址
	*　物理地址在映射表找到　跟踪记录的逻辑指针参考映射表
	*  提供了更大的灵活性 组织方式要求移动记录 或者在块转移记录对应的表项目
	*  逻辑地址和物理地址多种结构组合是可能的 得到结构化地址模式 使用块的物理地址
	加上访问记录的值 得到地址的记录合适键的记录
	* 物理逻辑地址组合是在块内存储的偏移量表 博爱村记录的偏移量
	* 记录地址是块的物理地址加上在块的偏移量 听了逻辑地址的许多优点 不需要一个全局映射表

* 在块内移动几率得到几率在移动偏量表中的表项 并指向这个指针找到
* 偏移的表足够大能存储足够记录的转向地址 可以允许记录移动到另一个块
*　如果记录被删除　偏移向量表留下一删除标记　被删除的特殊值　在删除前这个记录的指正可能存储在数据库中不同的地方
记录删除后　找到指针删除标记

* 指针混写
	*　指针地址长是记录的部分　表示关系元组记录不在遇到这种情况 即使是关系系统也在元组中表示指针　
	* 索引结构内部有指针块组成 主存储器和二级存储器之间移动的指针管理
	* 每个块　记录对象　或者引用数据类型　都有二种形式　在服务器数据库地址和内存地址　如果被拷贝到虚拟内存中 当数据在二级存储器中　使用到数据项的数据库地址
	* 当数据项在内存中的时候 通过二种指令可以找到数据项的职责使用内存地址更加高效 跟踪数据库地址费时的多 在虚拟数据中所用的地址转换成为当前的数据存档
		* 逻辑和物理地址是数据库地址的表示 转换的内存相当对象在内存中的拷贝
		*　数据库中可访问数据在映射表有表项　转换表只记载在内存中的数据项	
	* 为了避免指针混写 pointer swizzling 从块的二级存储器转移到主要存储器中 块内的指针可以混写从数据库地址空间转换为虚拟空间地址 
		* 一个二进制位 致命是数据库地址还是内存地址
		*　数据库或内存指针那个合适无论使用哪种空间相同　内存地址通常比数据库地址短

* 指针的自动混写　automatic swizz-ling 
	* 块存储的记录具有公开的模式 告诉我们记录在那个地址找到指针
	* 块被用于索引结构的一种 块在位置存储指针
	* 块首部存放一个指针位置列表

* 块返回磁盘
	* 块从主存移动到磁盘中块任何指针必须解除混写 内存地址碧必须有相应的数据库地址取代
	* 转换表可用二种类型的指针进行双向联系 给定的内存地址可用找到对应的数据库地址
	查找数据库地址 x联系的内存地址	
		* select memAddr from TranslationTable where dbAddr = x;
	 数据库地址作为建的的散列可用在dbAddr 属性上建立索引返向查询
		* select dbAddr From TranslationTable WHERE memAddr = y;

* 被定住的块
	* 内存中的一个快不能安全的写回磁盘称为被钉住的 块首可用有指明的块是否被在二进制位
	* 系统恢复 混写 都可能被订住
	* 将块写回磁盘时 不仅需要 解混写块的所有指针还要保证没有被钉住 留在内存中占用本有块的空间
	* 装换表必须记录在内存中的所有指针 对每个数据项混写的指针位置
		* 建一个内存地址引用位保存附近地址装换表中表项的链表
		* 如果内存地址在比数据库地址短 每个数据库指针的空间被代替
			* 被混写的指针
			* 另一个指针 被混写的指针构建的链表一部分
* 不能装入块中的记录	
	* DBMS常用管理大值手机开类型不能装入有空块中的值 
